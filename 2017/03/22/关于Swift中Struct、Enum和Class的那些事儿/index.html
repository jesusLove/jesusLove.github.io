<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>关于Swift中Struct、Enum和Class的那些事儿 | 繁华落尽</title><meta name="keywords" content="Swift,Struct Class Enum"><meta name="author" content="繁华落尽丶千,jesus_lqq@163.com"><meta name="copyright" content="繁华落尽丶千"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="关于Swift中Struct、Enum和Class的那些事儿"><meta name="application-name" content="关于Swift中Struct、Enum和Class的那些事儿"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="关于Swift中Struct、Enum和Class的那些事儿"><meta property="og:url" content="https://juesuslove.github.io/2017/03/22/%E5%85%B3%E4%BA%8ESwift%E4%B8%ADStruct%E3%80%81Enum%E5%92%8CClass%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/index.html"><meta property="og:site_name" content="繁华落尽"><meta property="og:description" content="前言Swift type System  Swift是强类型的，尽管只有六种类型。  命名类型： protocol, class , struct , enum 复合类型：tuple, function   可能会有疑问，那些基本类型：Bool，Int，UInt,  Float, Double, C"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="繁华落尽丶千"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="前言Swift type System  Swift是强类型的，尽管只有六种类型。  命名类型： protocol, class , struct , enum 复合类型：tuple, function   可能会有疑问，那些基本类型：Bool，Int，UInt,  Float, Double, C"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://juesuslove.github.io/2017/03/22/%E5%85%B3%E4%BA%8ESwift%E4%B8%ADStruct%E3%80%81Enum%E5%92%8CClass%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?bcdcd5cded4b5569656706ab1db4678e";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: {"apiKey":null,"indexName":"繁华落尽","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 繁华落尽丶千","link":"链接: ","source":"来源: 繁华落尽","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '繁华落尽',
  title: '关于Swift中Struct、Enum和Class的那些事儿',
  postAI: '',
  pageFillDescription: '前言, Struct Class and Enum 对比, 如何抉择？, Struct, Struct的定义和初始化, Struct 值类型本质, 为Struct添加方法, Enum, 定义enum, 理解Enum的Value, case 本身就是值, 绑定值(raw values), 关联值（Associated value), 协议和方法（Protocol and Method）, 什么是Copy on write  (COW) ？, 值类型和引用类型（Value vs. Reference Type）, 差异对比, Class, 理解class类型的各种init方法, 指定构造器(Designated init), 便利构造器 （convenience init）, 可失败构造器 （Failable init ）, 类的继承和构造过程, init的继承, 重载init方法, 两段式构造过程, 参考前言是强类型的尽管只有六种类型命名类型复合类型可能会有疑问那些基本类型实际上他们都是通过命名类型创建的对比中提供了多种可以结构化存储数据的方式它们是和标准库中的绝大多数类型都是甚至中的一些类也提供了它们在中的版本而和只占很少一部分对比表共同点都可以当作都可以使用扩充都可以使用泛型如何抉择通常在平时的编程中按照对象的生命周期形态可以把使用的类型分成两大类一类必须有明确生命周期的它们必须被明确的初始化使用最后明确的被释放例如文件句柄数据库连接线程同步锁等等这些类型的初始化和释放都不是拷贝内存这么简单通常这类内容我们会选择使用来实现另一类则是没有那么明显的生命周期例如整数字符串等等这些对象一旦被创建之后就很少被修改我们只是需要使用这些对象的值用完之后我们也无需为这些对象的销毁做更多额外的工作只是把它们占用的内存回收就好了这类内容通常我们会选择使用或来实现的定义和初始化定义结构体下面定义了一个二维空间坐标的类型这个结构体包含两个名和的存储属性存储属性是被绑定和存储在结构体中的常量或变量初始化结构体类型的逐一初始化所有的结构体都有一个自动生成的成员逐一构造器默认初始化我们也可以在定义的时候直接给属性初始化使用这种方法必须给每一个属性指定默认值因为中要求方法必须初始化自定义类型每个属性如果无法做到我们可以自定义逐一初始化方法当我们自定义方法之后将不会再自动创建逐一初始化方法值类型本质通过观察的变化当修改变量值时控制台输出但是修改的修改某个属性也会触发这就是值语义的本质即使字面上修改了变量的某个属性但实际执行的逻辑是重新给赋值一个新的对象为添加方法给添加的方法默认的都是只读的计算之间的距离当我们定义一个移动轴坐标点的方法时会导致编译错误这里提示必须使用修饰这个方法编译器就会在所有的方法第一个参数的位置自动添加一个参数以上是关于类型的基本内容方法的合成规则值语义在上的表现在中对做了诸多改进和增强它可以有自己的属性方法还可以遵从定义定义了一个枚举也可以写在同一行上用逗号隔开使用注意与和不同的枚举成员在被创建时不会被赋予一个默认的整数值上面定义的枚举成员是完备的值这些值的类型就是定义好的枚举或理解的本身就是值注意的类型可以通过推导出是因此可以省略的名字当将的所有的值都列举出来时可以省略绑定值在中默认不会为绑定一个整数值但是我们可以手动的绑定值这个绑定来的值叫做现在定义就会依次把绑定上值关联值在中我们可以给每一个绑定不同类型的值我们管这种值叫做定义了一个表示的使用注意提取关联值的内容时可以把和写在前面或者后面例如和协议和方法在中和其他的命名类型一样也可以采用例如给添加一个文本表示结果什么是是一种常见的计算机技术有助于在复制结构时提高性能例如一个数组中有个元素如果你复制数组到另一个变量将复制全部的元素即使最终两个数组的内容相同这个问题可以使用解决当将两个变量指向同一数组时他们指向相同的底层数据两个变量指向相同的数据可能看起来矛盾解决方法当修改第二个变量的时候才会去复制一个副本第一个不会改变通过延迟复制操作直到实际使用到的时候才去复制以此确保没有浪费的工作注意是特别添加到数组和字典的功能自定义的数据类型不会自动实现值类型和引用类型和有很多相似的地方他们都可以用来自定义类型都可以有属性都可以有方法作为中的引用类型表达的是一个具有明生命周期的对象我们关心的是类的生命周期而值类型我关注的是值本身差异对比引用类型必须明确指定方法中不会自动生成方法如果不定义编译器报错引用类型关注的是对象本身定义为定义为使用值类型创建新对象时将复制使用引用类型时新变量引用同一个对象这是两者的关键区别引用类型的默认值是可以修改的我们之前提到过给添加的方法默认的都是只读的如果要修改必须用来修饰中则不同我们可以直接给赋值理解类型的各种方法由于之间可以存在继承关系因此它的初始化过程要比复杂为了保证一个中的所有属性都被初始化中引入一系列特定规则这项写是不行了因为没有定义初始化方法指定构造器上面的有一个默认的初始化方法有两种办法第一种给每一个属性都添加默认值这种方法只能创建一个固定的另外一种添加一个方法添加个一个方法我们可以使用但是如果你现在使用结果会导致编译错误因为我们接手了的定义后编译就不会插手工作所以在定义方法时添加默认参数我们称这种初始化为便利构造器使用关键字修改必须调用完成对象的初始化如果直接调用或会导致编译错误可失败构造器由于版的可能失败所以需要用形式定义在实现里面如果无法转换为成则返回注意严格来说构造器都不支持返回值因为构造器本身的作用只是为了确保对象能被正确构造因此表示构造失败而不能表示成功类的继承和构造过程当类之间存在继承关系的时候为了保证派生类和基类的属性都被初始化采用以下三条规则限制构造器之间的代理调用指定构造器必须调用其直接父类的指定构造器便利构造器必须调用同类中定义的其它构造器便利构造器必须最终导致一个指定构造器被调用简单说指定构造器必须总是向上代理便利构造器必须总是横向代理的继承继承基类如果派生类没有定义任何那么它将自动继承所有基类的如果一个派生类定义了所有基类的那么它将自动继承基类所有的重载方法在派生类自定义表示明确控制派生类的初始化构造过程就不会干涉构造过程那么之前创建就会出现错误如果想让从继承所有的只有在派生类中实现所有的方法注意先后顺序此时就可以正常工作了只要派生类拥有基类所有的方法他就会自动获得所有基类的方法另外重载基类方法是不需要关键字修饰的两段式构造过程为了保证在一个继承关系中派生类和基类的属性都可以正确初始化而约定的初始化机制简单来说这个机制把派生类的初始化过程分成了两个阶段阶段一从派生类到基类自下而上让类的每个属性有初始值阶段二所有属性都有初始值之后从基类到派生类自上而下对类的每个属性进行进一步加工两段式构造过程让构造过程更安全同时整个类层级结构中给予了每个类完全的灵活性两段式构造过程可以防止属性值在初始化之前被访问也可以防止属性被另外一个构造器意外赋予不同的值参考如何学习编程语言泊学',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-02 15:22:46',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">繁华落尽</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/images/wechatpay.png" target="_blank"><img class="post-qr-code-img" alt="微信" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/wechatpay.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/images/alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Alamofire/" style="font-size: 1.05rem;">Alamofire<sup>1</sup></a><a href="/tags/CoreAnimation/" style="font-size: 1.05rem;">CoreAnimation<sup>1</sup></a><a href="/tags/Electron/" style="font-size: 1.05rem;">Electron<sup>2</sup></a><a href="/tags/Flexbox/" style="font-size: 1.05rem;">Flexbox<sup>1</sup></a><a href="/tags/Git/" style="font-size: 1.05rem;">Git<sup>3</sup></a><a href="/tags/Git%E9%97%AE%E9%A2%98/" style="font-size: 1.05rem;">Git问题<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 1.05rem;">JavaScript<sup>8</sup></a><a href="/tags/Koa/" style="font-size: 1.05rem;">Koa<sup>2</sup></a><a href="/tags/Node-js/" style="font-size: 1.05rem;">Node.js<sup>1</sup></a><a href="/tags/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/" style="font-size: 1.05rem;">事件循环<sup>1</sup></a><a href="/tags/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/" style="font-size: 1.05rem;">作用域链<sup>1</sup></a><a href="/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE/" style="font-size: 1.05rem;">原型链<sup>2</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">对象<sup>1</sup></a><a href="/tags/%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/" style="font-size: 1.05rem;">开机自启<sup>1</sup></a><a href="/tags/%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/" style="font-size: 1.05rem;">异步任务<sup>1</sup></a><a href="/tags/%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87/" style="font-size: 1.05rem;">执行上下文<sup>1</sup></a><a href="/tags/%E6%89%A7%E8%A1%8C%E6%A0%88/" style="font-size: 1.05rem;">执行栈<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E6%89%98%E7%9B%98/" style="font-size: 1.05rem;">系统托盘<sup>1</sup></a><a href="/tags/%E7%BB%A7%E6%89%BF/" style="font-size: 1.05rem;">继承<sup>1</sup></a><a href="/tags/%E9%97%AD%E5%8C%85/" style="font-size: 1.05rem;">闭包<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/07/"><span class="card-archive-list-date">七月 2020</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/11/"><span class="card-archive-list-date">十一月 2019</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/10/"><span class="card-archive-list-date">十月 2019</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">7</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/03/"><span class="card-archive-list-date">三月 2019</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2019/02/"><span class="card-archive-list-date">二月 2019</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2018/10/"><span class="card-archive-list-date">十月 2018</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2018/09/"><span class="card-archive-list-date">九月 2018</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2018/03/"><span class="card-archive-list-date">三月 2018</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url">编程语言</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Swift/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Swift</span></a><a class="article-meta__tags" href="/tags/Struct-Class-Enum/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Struct Class Enum</span></a></span></div></div><h1 class="post-title" itemprop="name headline">关于Swift中Struct、Enum和Class的那些事儿</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2017-03-22T07:05:02.000Z" title="发表于 2017-03-22 15:05:02">2017-03-22</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2023-11-02T07:22:46.719Z" title="更新于 2023-11-02 15:22:46">2023-11-02</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">3.4k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="关于Swift中Struct、Enum和Class的那些事儿"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为山东"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>山东</span></div></div></div><article class="post-content" id="article-container" itemscope itemtype="https://juesuslove.github.io/2017/03/22/%E5%85%B3%E4%BA%8ESwift%E4%B8%ADStruct%E3%80%81Enum%E5%92%8CClass%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"><header><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url">编程语言</a><a href="/tags/Swift/" tabindex="-1" itemprop="url">Swift</a><a href="/tags/Struct-Class-Enum/" tabindex="-1" itemprop="url">Struct Class Enum</a><h1 id="CrawlerTitle" itemprop="name headline">关于Swift中Struct、Enum和Class的那些事儿</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">繁华落尽丶千</span><time itemprop="dateCreated datePublished" datetime="2017-03-22T07:05:02.000Z" title="发表于 2017-03-22 15:05:02">2017-03-22</time><time itemprop="dateCreated datePublished" datetime="2023-11-02T07:22:46.719Z" title="更新于 2023-11-02 15:22:46">2023-11-02</time></header><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><strong>Swift type System</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="http://upload-images.jianshu.io/upload_images/1363078-2e345f512c635c19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/640" alt="types.png"></p>
<p>Swift是强类型的，尽管只有六种类型。</p>
<ul>
<li>命名类型： protocol, class , struct , enum</li>
<li>复合类型：tuple, function</li>
</ul>
<blockquote>
<p>可能会有疑问，那些基本类型：Bool，Int，UInt,  Float, Double, Character, String, Array, Set,  Dictionary,  Optional。实际上他们都是通过命名类型创建的。</p>
</blockquote>
<h1 id="Struct-Class-and-Enum-对比"><a href="#Struct-Class-and-Enum-对比" class="headerlink" title="Struct Class and Enum 对比"></a>Struct Class and Enum 对比</h1><p>Swift中提供了多种可以结构化存储数据的方式，它们是： <code>struct</code>、<code>enum</code>和<br><code>class</code>。Swift标准库中的绝大多数类型都是<code>struct</code>,甚至Foundation中的一些类也提供了它们在Swift中的<code>struct</code>版本，而<code>class</code>和<code>enum</code>只占很少一部分。</p>
<p>Class,Struct and Enum对比表</p>
<p>|copy by| inheritance| static variable | instance variable| static method | instance method<br>——–|——–|——–|——–|——–|——–|——–|——–<br>Class | Reference | ✅| ✅ |✅|✅|✅<br>Struct| Value| ✘|✅ |✅|✅|✅<br>Enum|Value|✘|✅ |✘|✅ |✅|<br>共同点：</p>
<ol>
<li>都可以当作<code>protocol</code></li>
<li>都可以使用<code>extension</code>,扩充<code>method</code></li>
<li>都可以使用泛型</li>
</ol>
<h1 id="如何抉择？"><a href="#如何抉择？" class="headerlink" title="如何抉择？"></a>如何抉择？</h1><p>通常，在平时的编程中，按照对象的生命周期形态，可以把使用的类型分成两大类：</p>
<ul>
<li><strong>一类必须有明确生命周期的，它们必须被明确的初始化、使用、最后明确的被释放</strong>。例如：文件句柄、数据库连接、线程同步锁等等。这些类型的初始化和释放都不是拷贝内存这么简单，通常，这类内容，我们会选择使用<code>class</code>来实现。</li>
<li><strong>另一类，则是没有那么明显的生命周期。</strong> 例如：整数、字符串、URL等等。这些对象一旦被创建之后，就很少被修改，我们只是需要使用这些对象的值，用完之后，我们也无需为这些对象的销毁做更多额外的工作，只是把它们占用的内存回收就好了。这类内容，通常我们会选择使用<code>struct</code>或<code>enum</code>来实现。</li>
</ul>
<h1 id="Struct"><a href="#Struct" class="headerlink" title="Struct"></a>Struct</h1><h2 id="Struct的定义和初始化"><a href="#Struct的定义和初始化" class="headerlink" title="Struct的定义和初始化"></a>Struct的定义和初始化</h2><p> **  定义结构体  **<br>下面定义了一个二维空间坐标的类型：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">struct Point &#123;</span><br><span class="line">    var x: Double</span><br><span class="line">    var y: Double</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个结构体包含两个名x和y的存储属性。存储属性是被绑定和存储在结构体中的常量或变量。</p>
<p>** 初始化 ** </p>
<ul>
<li><p>结构体类型的逐一初始化<br>所有的结构体都有一个自动生成的成员逐一构造器</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var pointA = Point(x: 10, y: 20)</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认初始化<br>我们也可以在定义的时候直接给属性初始化</p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">struct Point &#123;</span><br><span class="line">   var x = 0.0</span><br><span class="line">   	var y = 0.0</span><br><span class="line">&#125;</span><br><span class="line">var pointB = Point()</span><br></pre></td></tr></table></figure></li>
</ul>
<p>使用这种方法，<strong>必须给每一个属性指定默认值</strong>。因为Swift中要求<code>init</code>方法必须初始化自定义类型每个属性。如果无法做到，我们可以自定义逐一初始化方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">struct Point &#123;</span><br><span class="line">    var x : Double</span><br><span class="line">    var y : Double</span><br><span class="line">    init(_ x : Double = 0.0, y : Double = 0.0) &#123;</span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当我们自定义<code>init</code>方法之后，Swift将不会再自动创建逐一初始化方法。</p>
<h2 id="Struct-值类型本质"><a href="#Struct-值类型本质" class="headerlink" title="Struct 值类型本质"></a>Struct 值类型本质</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">var pointB = Point(200, y: 100)</span><br><span class="line">var pointC = Point(100, y: 200) &#123;</span><br><span class="line">    didSet &#123;</span><br><span class="line">        print(&quot;\(pointC)&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">pointC = pointB</span><br><span class="line">// Point(x: 200.0, y: 100.0)</span><br><span class="line">pointC.x = 200</span><br><span class="line">//Point(x: 200.0, y: 100.0)</span><br></pre></td></tr></table></figure>

<p>通过<code>didSet</code>观察<code>pointC</code>的变化。当修改<code>pointC</code>变量值时，控制台输出<code>Point(x: 200.0, y: 100.0)</code>, 但是，修改<code>pointC</code>的修改某个属性，也会触发<code>didSet</code>。 </p>
<p>这就是值语义的本质：即使字面上修改了<code>pointC</code>变量的某个属性，但实际执行的逻辑是重新给<code>pointC</code>赋值一个新的<code>Point</code>对象。</p>
<h2 id="为Struct添加方法"><a href="#为Struct添加方法" class="headerlink" title="为Struct添加方法"></a>为Struct添加方法</h2><p>给<code>struct</code>添加的方法，默认的都是只读的。计算Point之间的距离</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">extension Point &#123;</span><br><span class="line">    func distance(to: Point) -&gt; Double &#123;</span><br><span class="line">        let distX = self.x - to.x</span><br><span class="line">        let distY = self.y - to.y</span><br><span class="line">        return sqrt(distX * distX + distY * distY)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">pointC.distance(to: Point(0, y: 0))</span><br></pre></td></tr></table></figure>
<p>当我们定义一个移动X轴坐标点的方法时，会导致编译错误:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">extension Point &#123;</span><br><span class="line">    func move(to: Point) &#123;</span><br><span class="line">        self = to </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里提示self is immutable , 必须使用<code>mutating</code>修饰这个方法， Swift编译器就会在所有的<code>mutating</code>方法第一个参数的位置，自动添加一个 <code>inout Self</code>参数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">extension Point &#123;</span><br><span class="line">    /* self: inout Self */</span><br><span class="line">    mutating func move(to: Point) &#123;</span><br><span class="line">        self = to</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上，是关于Struct类型的基本内容。</p>
<ul>
<li><code>init</code>方法的合成规则</li>
<li>值语义在<code>struct</code>上的表现</li>
</ul>
<h1 id="Enum"><a href="#Enum" class="headerlink" title="Enum"></a>Enum</h1><p>在Swift中，对<code>enum</code>做了诸多改进和增强，它可以有自己的属性，方法，还可以遵从<code>protocol</code>。</p>
<h2 id="定义enum"><a href="#定义enum" class="headerlink" title="定义enum"></a>定义enum</h2><p>定义了一个<code>colorName</code>枚举</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">enum ColorName &#123;</span><br><span class="line">    case black</span><br><span class="line">    case silver</span><br><span class="line">    case gray</span><br><span class="line">    case white</span><br><span class="line">    case red</span><br><span class="line">    //.... and so on ....</span><br><span class="line">&#125;</span><br><span class="line">// 也可以写在同一行上，用逗号隔开：</span><br><span class="line">enum Month &#123;</span><br><span class="line">    case january, februray, march,</span><br><span class="line">    april, may, june, july,</span><br><span class="line">    august, september, october,</span><br><span class="line">    november, december</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let black = ColorName.black</span><br><span class="line">let jan = Month.january</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：<br>与C和Objective-C不同，Swift的枚举成员在被创建时不会被赋予一个默认的整数值。上面定义的枚举成员是完备的值，这些值的类型就是定义好的枚举<code>ColorName</code>或<code>Month</code>。</p>
</blockquote>
<h2 id="理解Enum的“Value”"><a href="#理解Enum的“Value”" class="headerlink" title="理解Enum的“Value”"></a>理解Enum的“Value”</h2><h3 id="case-本身就是值"><a href="#case-本身就是值" class="headerlink" title="case 本身就是值"></a>case 本身就是值</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">func myColor(color: ColorName) -&gt; String &#123;</span><br><span class="line">    switch color &#123;</span><br><span class="line">    case .black:</span><br><span class="line">        return &quot;black&quot;</span><br><span class="line">    case .red:</span><br><span class="line">        return &quot;red&quot;</span><br><span class="line">    default :</span><br><span class="line">        return &quot;other&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意</p>
<ul>
<li>color的类型可以通过<code>type inference</code>推导出是<code>ColorName</code>。因此，可以省略<code>enum</code>的名字。</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>当Switch…case…将color的所有的值都列举出来时，可以省略<code>default</code>。</li>
</ul>
</blockquote>
<h3 id="绑定值-raw-values"><a href="#绑定值-raw-values" class="headerlink" title="绑定值(raw values)"></a>绑定值(raw values)</h3><p>在Swift中，<code>enum</code>默认不会为<code>case</code>绑定一个整数值。但是我们可以手动的绑定值，这个“绑定”来的值，叫做raw values。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enum Direction : Int &#123;</span><br><span class="line">    case east</span><br><span class="line">    case south</span><br><span class="line">    case west</span><br><span class="line">    case north</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在定义Direction，Swift就会依次把<code>case</code>绑定上值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let east = Direction.east.rawValue // 0</span><br></pre></td></tr></table></figure>
<h3 id="关联值（Associated-value"><a href="#关联值（Associated-value" class="headerlink" title="关联值（Associated value)"></a>关联值（Associated value)</h3><p>在Swift中， 我们可以给每一个<code>case</code>绑定不同类型的值，我们管这种值叫做<code>Associated value</code>。</p>
<p>定义了一个表示CSSColor的<code>enum</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enum CSSColor &#123;</span><br><span class="line">    case named(ColorName)</span><br><span class="line">    case rgb(UInt8, UInt8, UInt8)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var color1 = CSSColor.named(.black)</span><br><span class="line">var color2 = CSSColor.rgb(0xAA, 0xAA, 0xAA)</span><br><span class="line">switch color2 &#123;</span><br><span class="line">case  let  .named(color):</span><br><span class="line">     print(&quot;\(color)&quot;)</span><br><span class="line">case .rgb(let r, let g, let b):</span><br><span class="line">    print(&quot;\(r), \(g), \(b)&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：<br>提取”关联值“的内容时，可以把<code>let</code>和<code>var</code>写在<code>case</code>前面或者后面。例如：<code>named</code>和<code>rgb</code>。</p>
</blockquote>
<h2 id="协议和方法（Protocol-and-Method）"><a href="#协议和方法（Protocol-and-Method）" class="headerlink" title="协议和方法（Protocol and Method）"></a>协议和方法（Protocol and Method）</h2><p>在Swift中，<code>enum</code>和其他的命名类型一样，也可以采用<code>protocol</code>。</p>
<p>例如： 给CSSColor添加一个文本表示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">extension CSSColor: CustomStringConvertible &#123;</span><br><span class="line">    var description: String &#123;</span><br><span class="line">        switch self &#123;</span><br><span class="line">        case .named(let colorname):</span><br><span class="line">            return colorname.rawValue</span><br><span class="line">        case .rgb(let red, let green, let blue):</span><br><span class="line">            return String(format: &quot;#%02X%02X%02X&quot;, red, green, blue)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">let color3 = CSSColor.named(.red)</span><br><span class="line">let color4 = CSSColor.rgb(0xBB, 0xBB, 0xBB)</span><br><span class="line">print(&quot;color3=\(color3), color4=\(color4)&quot;) </span><br><span class="line">//color3=red, color4=#BBBBBB</span><br></pre></td></tr></table></figure>

<h1 id="什么是Copy-on-write-COW-？"><a href="#什么是Copy-on-write-COW-？" class="headerlink" title="什么是Copy on write  (COW) ？"></a>什么是Copy on write  (COW) ？</h1><p> COW是一种常见的计算机技术，有助于在复制结构时提高性能。例如：一个数组中有1000个元素，如果你复制数组到另一个变量，Swift将复制全部的元素，即使最终两个数组的内容相同。</p>
<p>这个问题可以使用COW解决：当将两个变量指向同一数组时，他们指向相同的底层数据。两个变量指向相同的数据可能看起来矛盾。解决方法：当修改第二个变量的时候，Swift才会去复制一个副本，第一个不会改变。<br>通过延迟复制操作，直到实际使用到的时候 才去复制，以此确保没有浪费的工作。</p>
<blockquote>
<p>注意：COW是特别添加到Swift数组和字典的功能，自定义的数据类型不会自动实现。</p>
</blockquote>
<h1 id="值类型和引用类型（Value-vs-Reference-Type）"><a href="#值类型和引用类型（Value-vs-Reference-Type）" class="headerlink" title="值类型和引用类型（Value vs. Reference Type）"></a>值类型和引用类型（Value vs. Reference Type）</h1><p>Class和Struct有很多相似的地方，他们都可以用来自定义类型、都可以有属性、都可以有方法。作为Swift中的引用类型，<code>class</code>表达的是一个具有明生命周期的对象，我们关心的是类的生命周期。而值类型，我关注的是值本身。</p>
<h2 id="差异对比"><a href="#差异对比" class="headerlink" title="差异对比"></a>差异对比</h2><ol>
<li>引用类型必须明确指定init方法<br> Swift中<code>class</code>不会自动生成<code>init</code>方法。如果不定义编译器报错。</li>
<li>引用类型关注的是对象本身<br>Circle (定义为Class)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var a = Circle()</span><br><span class="line">a.radius = 80</span><br><span class="line">var b = a</span><br><span class="line">a.radius = 1000</span><br><span class="line">b.radius // 1000</span><br></pre></td></tr></table></figure>
Circle(定义为Struct)</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var a = Circle()</span><br><span class="line">a.radius = 80</span><br><span class="line">var b = a</span><br><span class="line">a.radius = 1000</span><br><span class="line">b.radius // 80</span><br></pre></td></tr></table></figure>
<p>使用值类型创建新对象时，将复制；使用引用类型时，新变量引用同一个对象。这是两者的关键区别。</p>
<ol start="3">
<li>引用类型的默认值是可以修改的<br>  我们之前提到过，给<code>struct</code>添加的方法，默认的都是只读的。如果要修改必须用<code>mutating</code>来修饰。<code>class</code>中则不同，我们可以直接给 <code>self</code>赋值。</li>
</ol>
<h1 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h1><h2 id="理解class类型的各种init方法"><a href="#理解class类型的各种init方法" class="headerlink" title="理解class类型的各种init方法"></a>理解class类型的各种init方法</h2><p>由于<code>class</code>之间可以存在继承关系，因此它的初始化过程要比<code>struct</code>复杂，为了保证一个<code>class</code>中的所有属性都被初始化，Swift中引入一系列特定规则。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class Point2D &#123;</span><br><span class="line">    var x : Double</span><br><span class="line">    var y : Double</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这项写是不行了，因为没有定义初始化方法。</p>
<h3 id="指定构造器-Designated-init"><a href="#指定构造器-Designated-init" class="headerlink" title="指定构造器(Designated init)"></a>指定构造器(Designated init)</h3><p>上面的Point2D有一个默认的初始化方法，有两种办法：第一种给每一个属性都添加默认值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class Point2D &#123;</span><br><span class="line">    var x : Double = 0</span><br><span class="line">    var y : Double = 0</span><br><span class="line">&#125;</span><br><span class="line">let origin = Point2D()</span><br></pre></td></tr></table></figure>
<p>这种方法只能创建一个固定的<code>class</code>。另外一种，添加一个<code>memberwise init</code> 方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class Point2D &#123;</span><br><span class="line">    var x : Double = 0</span><br><span class="line">    var y : Double = 0</span><br><span class="line">    init(x: Double, y: Double) &#123;</span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>添加个一个<code>memberwise init</code>方法，我们可以使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let point = Point2D(x: 1, y: 1)</span><br></pre></td></tr></table></figure>
<p>但是，如果你现在使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let point = Point2D()  // Error </span><br></pre></td></tr></table></figure>
<p>结果会导致编译错误。 因为，我们接手了<code>init</code>的定义后，编译就不会插手<code>init</code>工作。所以，在定义<code>init</code>方法时添加默认参数， 我们称这种初始化为 <code>designated init</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class Point2D &#123;</span><br><span class="line">    var x : Double = 0</span><br><span class="line">    var y : Double = 0</span><br><span class="line">    init(x: Double = 0, y: Double = 0) &#123;</span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="便利构造器-（convenience-init）"><a href="#便利构造器-（convenience-init）" class="headerlink" title="便利构造器 （convenience init）"></a>便利构造器 （convenience init）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class Point2D &#123;</span><br><span class="line">    var x : Double = 0</span><br><span class="line">    var y : Double = 0</span><br><span class="line">    init(x: Double = 0, y: Double = 0) &#123;</span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line">    &#125;</span><br><span class="line">    convenience init(at: (Double, Double) ) &#123;</span><br><span class="line">        self.init(x: at.0, y: at.1)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用<code>convenience</code>关键字修改；</li>
<li>必须调用<code>designated init</code>完成对象的初始化；如果直接调用self.x或self.y，会导致编译错误。</li>
</ul>
<h3 id="可失败构造器-（Failable-init-）"><a href="#可失败构造器-（Failable-init-）" class="headerlink" title="可失败构造器 （Failable init ）"></a>可失败构造器 （Failable init ）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">class Point2D &#123;</span><br><span class="line">    // .... </span><br><span class="line">    convenience init?(at: (String, String)) &#123;</span><br><span class="line">        guard let x = Double(at.0),   let y = Double(at.1) else &#123;</span><br><span class="line">          return nil</span><br><span class="line">        &#125;</span><br><span class="line">        self.init(at:(x, y))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由于<code>String tuple</code>版的init可能失败，所以需要用<code>init?</code>形式定义。在实现里面，如果<code>String</code>无法转换为成<code>Double</code>， 则返回<code>nil</code>。</p>
<blockquote>
<p>注意：<br>严格来说，构造器都不支持返回值。因为构造器本身的作用，只是为了确保对象能被正确构造。因此，<code>return nil</code>表示构造失败，而不能<code>return</code>表示成功。</p>
</blockquote>
<h2 id="类的继承和构造过程"><a href="#类的继承和构造过程" class="headerlink" title="类的继承和构造过程"></a>类的继承和构造过程</h2><p>当类之间存在继承关系的时候，为了保证派生类和基类的属性都被初始化，Swift采用以下三条规则限制构造器之间的代理调用：</p>
<ul>
<li>指定构造器必须调用其直接父类的指定构造器</li>
<li>便利构造器必须调用同类中定义的其它构造器</li>
<li>便利构造器必须最终导致一个指定构造器被调用</li>
</ul>
<p>简单说：</p>
<ul>
<li>指定构造器必须总是<em>向上代理</em></li>
<li>便利构造器必须总是<em>横向代理</em></li>
</ul>
<h3 id="init的继承"><a href="#init的继承" class="headerlink" title="init的继承"></a>init的继承</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class Point3D: Point2D &#123;</span><br><span class="line">    var z: Double = 0</span><br><span class="line">&#125;</span><br><span class="line">let origin3D = Point3D()</span><br><span class="line">let point31 = Point3D(x: 1, y: 1)</span><br><span class="line">let point33 = Point3D(at: (2, 3)) // 继承基类 convenience init</span><br></pre></td></tr></table></figure>

<ul>
<li>如果派生类没有定义任何<code>designated initializer</code>，那么它将自动继承所有基类的<code>designated initializer</code>。</li>
<li>如果一个派生类定义了所有基类的<code>designated init</code>,那么它将自动继承基类所有的<code>convenience init</code>。</li>
</ul>
<h3 id="重载init方法"><a href="#重载init方法" class="headerlink" title="重载init方法"></a>重载init方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Point3D: Point2D &#123;</span><br><span class="line">    var z: Double</span><br><span class="line">    init(x: Double = 0, y: Double = 0, z: Double = 0) &#123;</span><br><span class="line">        self.z = z</span><br><span class="line">        super.init(x: x, y: y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在派生类自定义<code>designated init</code>, 表示明确控制派生类的初始化构造过程, Swift 就不会干涉构造过程。那么，之前创建<code>Point3D</code>就会出现错误。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">let point33 = Point3D(at: (2, 3))  // Error </span><br></pre></td></tr></table></figure>
<p>如果想让<code>Point3D</code>从<code>Point2D</code>继承所有的<code>convenience init</code>，只有在派生类中实现所有的<code>designated init</code>方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class Point3D: Point2D &#123;</span><br><span class="line">    var z: Double</span><br><span class="line">    init(x: Double = 0, y: Double = 0, z: Double = 0) &#123;</span><br><span class="line">        self.z = z</span><br><span class="line">        super.init(x: x, y: y)</span><br><span class="line">    &#125;</span><br><span class="line">    override init(x: Double, y: Double) &#123;</span><br><span class="line">        // 注意先后顺序</span><br><span class="line">        self.z = 0</span><br><span class="line">        super.init(x: x, y: y)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时，就可以正常工作了。只要派生类拥有基类所有的<code>designated init</code>方法，他就会自动获得所有基类的<code>convenience init</code>方法。另外，重载基类<code>convenience init</code>方法，是不需要<code>override</code>关键字修饰的。</p>
<h3 id="两段式构造过程"><a href="#两段式构造过程" class="headerlink" title="两段式构造过程"></a>两段式构造过程</h3><p>Swift为了保证在一个继承关系中，派生类和基类的属性都可以正确初始化而约定的初始化机制。简单来说，这个机制把派生类的初始化过程分成了两个阶段。</p>
<ul>
<li><strong>阶段一： 从派生类到基类，自下而上让类的每个属性有初始值</strong></li>
<li><strong>阶段二：所有属性都有初始值之后，从基类到派生类，自上而下对类的每个属性进行进一步加工。</strong></li>
</ul>
<p>两段式构造过程让构造过程更安全，同时整个类层级结构中给予了每个类完全的灵活性。两段式构造过程可以防止属性值在初始化之前被访问，也可以防止属性被另外一个构造器意外赋予不同的值。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="">The swift Programming Language</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/reference/swift">Swift Standard Library</a></li>
<li><a target="_blank" rel="noopener" href="https://www.boxueio.com/skill/swift">如何学习Swift编程语言-泊学</a></li>
<li><a target="_blank" rel="noopener" href="https://www.raywenderlich.com/119881/enums-structs-and-classes-in-swift">Getting to Know Enums, Structs and Classes in Swift - raywenderlich</a></li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">繁华落尽丶千</div><div class="post-copyright__author_desc">面朝大海 春暖花开</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://juesuslove.github.io/2017/03/22/%E5%85%B3%E4%BA%8ESwift%E4%B8%ADStruct%E3%80%81Enum%E5%92%8CClass%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://juesuslove.github.io/2017/03/22/%E5%85%B3%E4%BA%8ESwift%E4%B8%ADStruct%E3%80%81Enum%E5%92%8CClass%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/')">关于Swift中Struct、Enum和Class的那些事儿</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="/images/wechatpay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/wechatpay.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/images/alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://juesuslove.github.io/2017/03/22/%E5%85%B3%E4%BA%8ESwift%E4%B8%ADStruct%E3%80%81Enum%E5%92%8CClass%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=undefined&amp;url=https://juesuslove.github.io/2017/03/22/%E5%85%B3%E4%BA%8ESwift%E4%B8%ADStruct%E3%80%81Enum%E5%92%8CClass%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/&amp;pic=undefined" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://juesusLove.github.io" target="_blank">繁华落尽</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Swift/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Swift<span class="tagsPageCount">5</span></a><a class="post-meta__box__tags" href="/tags/Struct-Class-Enum/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Struct Class Enum<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2017/03/20/%E4%BB%8E-HTTP1-x-%E5%88%B0-HTTP-2-0-%E5%8F%98%E8%BF%81/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">从 HTTP1.x 到 HTTP 2.0 变迁</div></div></a></div><div class="next-post pull-right"><a href="/2017/04/28/%E5%88%9D%E8%AF%86Bluetooth%E5%BC%80%E5%8F%91/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">初识Bluetooth开发</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2016/07/29/Swift%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%EF%BC%88%E4%B8%80%EF%BC%89/" title="Swift基本语法(一)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2023-11-02</div><div class="title">Swift基本语法(一)</div></div></a></div><div><a href="/2016/11/25/Swift-Tutorial/" title="Swift Tutorial"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2023-11-02</div><div class="title">Swift Tutorial</div></div></a></div><div><a href="/2016/07/30/Swift%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95%EF%BC%88%E4%BA%8C%EF%BC%89/" title="Swift基本语法（二）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2023-11-02</div><div class="title">Swift基本语法（二）</div></div></a></div><div><a href="/2019/02/26/iOS%E5%BC%80%E5%8F%91%E8%BF%9B%E9%98%B6%EF%BC%9ASwift-5-0-ABI-%E7%A8%B3%E5%AE%9A/" title="iOS开发进阶：Swift 5.0 ABI 稳定"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-history fa-fw"></i> 2023-11-02</div><div class="title">iOS开发进阶：Swift 5.0 ABI 稳定</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2021/06/20/df86832b6b15c.png" ait="status"/></div></div><div class="author-info__description">一名 90 后程序员大叔</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/about"><h1 class="author-info__name">繁华落尽丶千</h1><div class="author-info__desc">面朝大海 春暖花开</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/jesusLove" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Struct-Class-and-Enum-%E5%AF%B9%E6%AF%94"><span class="toc-number">2.</span> <span class="toc-text">Struct Class and Enum 对比</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%8A%89%E6%8B%A9%EF%BC%9F"><span class="toc-number">3.</span> <span class="toc-text">如何抉择？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Struct"><span class="toc-number">4.</span> <span class="toc-text">Struct</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Struct%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">4.1.</span> <span class="toc-text">Struct的定义和初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Struct-%E5%80%BC%E7%B1%BB%E5%9E%8B%E6%9C%AC%E8%B4%A8"><span class="toc-number">4.2.</span> <span class="toc-text">Struct 值类型本质</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BAStruct%E6%B7%BB%E5%8A%A0%E6%96%B9%E6%B3%95"><span class="toc-number">4.3.</span> <span class="toc-text">为Struct添加方法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Enum"><span class="toc-number">5.</span> <span class="toc-text">Enum</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89enum"><span class="toc-number">5.1.</span> <span class="toc-text">定义enum</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3Enum%E7%9A%84%E2%80%9CValue%E2%80%9D"><span class="toc-number">5.2.</span> <span class="toc-text">理解Enum的“Value”</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#case-%E6%9C%AC%E8%BA%AB%E5%B0%B1%E6%98%AF%E5%80%BC"><span class="toc-number">5.2.1.</span> <span class="toc-text">case 本身就是值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%91%E5%AE%9A%E5%80%BC-raw-values"><span class="toc-number">5.2.2.</span> <span class="toc-text">绑定值(raw values)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E8%81%94%E5%80%BC%EF%BC%88Associated-value"><span class="toc-number">5.2.3.</span> <span class="toc-text">关联值（Associated value)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E5%92%8C%E6%96%B9%E6%B3%95%EF%BC%88Protocol-and-Method%EF%BC%89"><span class="toc-number">5.3.</span> <span class="toc-text">协议和方法（Protocol and Method）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFCopy-on-write-COW-%EF%BC%9F"><span class="toc-number">6.</span> <span class="toc-text">什么是Copy on write  (COW) ？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%80%BC%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%EF%BC%88Value-vs-Reference-Type%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">值类型和引用类型（Value vs. Reference Type）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%AE%E5%BC%82%E5%AF%B9%E6%AF%94"><span class="toc-number">7.1.</span> <span class="toc-text">差异对比</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Class"><span class="toc-number">8.</span> <span class="toc-text">Class</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%90%86%E8%A7%A3class%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%90%84%E7%A7%8Dinit%E6%96%B9%E6%B3%95"><span class="toc-number">8.1.</span> <span class="toc-text">理解class类型的各种init方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E5%AE%9A%E6%9E%84%E9%80%A0%E5%99%A8-Designated-init"><span class="toc-number">8.1.1.</span> <span class="toc-text">指定构造器(Designated init)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%BF%E5%88%A9%E6%9E%84%E9%80%A0%E5%99%A8-%EF%BC%88convenience-init%EF%BC%89"><span class="toc-number">8.1.2.</span> <span class="toc-text">便利构造器 （convenience init）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%A4%B1%E8%B4%A5%E6%9E%84%E9%80%A0%E5%99%A8-%EF%BC%88Failable-init-%EF%BC%89"><span class="toc-number">8.1.3.</span> <span class="toc-text">可失败构造器 （Failable init ）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF%E5%92%8C%E6%9E%84%E9%80%A0%E8%BF%87%E7%A8%8B"><span class="toc-number">8.2.</span> <span class="toc-text">类的继承和构造过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#init%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="toc-number">8.2.1.</span> <span class="toc-text">init的继承</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E8%BD%BDinit%E6%96%B9%E6%B3%95"><span class="toc-number">8.2.2.</span> <span class="toc-text">重载init方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E6%AE%B5%E5%BC%8F%E6%9E%84%E9%80%A0%E8%BF%87%E7%A8%8B"><span class="toc-number">8.2.3.</span> <span class="toc-text">两段式构造过程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">9.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2020/07/13/Koa%E4%BD%BF%E7%94%A8Sqlite3%E5%92%8CSequelize/" title="Koa使用Sqlite3和Sequelize">Koa使用Sqlite3和Sequelize</a><time datetime="2020-07-13T02:16:06.000Z" title="发表于 2020-07-13 10:16:06">2020-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2020/07/13/Electron%E5%AD%90%E8%BF%9B%E7%A8%8B%E5%BC%80%E5%90%AFKoa%E5%BE%AE%E6%9C%8D%E5%8A%A1/" title="Electron子进程开启Koa微服务">Electron子进程开启Koa微服务</a><time datetime="2020-07-13T02:09:01.000Z" title="发表于 2020-07-13 10:09:01">2020-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2020/07/13/Electron%E6%89%98%E7%9B%98-%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF%E5%8A%A8/" title="Electron托盘&amp;开机自启动">Electron托盘&amp;开机自启动</a><time datetime="2020-07-13T01:19:10.000Z" title="发表于 2020-07-13 09:19:10">2020-07-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2019/11/25/TypeScript-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83-%E4%B8%89-%EF%BC%9A%E6%A8%A1%E5%9D%97%E3%80%81%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E3%80%81%E5%A3%B0%E6%98%8E%E5%90%88%E5%B9%B6%E3%80%81%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6/" title="TypeScript 从入门到放弃(三)：模块、命名空间、声明合并、声明文件">TypeScript 从入门到放弃(三)：模块、命名空间、声明合并、声明文件</a><time datetime="2019-11-25T07:32:01.000Z" title="发表于 2019-11-25 15:32:01">2019-11-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2019/11/12/TypeScript-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83-%E4%BA%8C-%E6%B3%9B%E5%9E%8B%E3%80%81%E9%AB%98%E7%BA%A7%E7%B1%BB%E5%9E%8B/" title="TypeScript 从入门到放弃(二):泛型、高级类型">TypeScript 从入门到放弃(二):泛型、高级类型</a><time datetime="2019-11-12T06:23:17.000Z" title="发表于 2019-11-12 14:23:17">2019-11-12</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2023 By <a class="footer-bar-link" href="/" title="繁华落尽丶千" target="_blank">繁华落尽丶千</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">62</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">7</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Alamofire/" style="font-size: 0.88rem;">Alamofire<sup>1</sup></a><a href="/tags/CoreAnimation/" style="font-size: 0.88rem;">CoreAnimation<sup>1</sup></a><a href="/tags/Electron/" style="font-size: 0.88rem;">Electron<sup>2</sup></a><a href="/tags/Flexbox/" style="font-size: 0.88rem;">Flexbox<sup>1</sup></a><a href="/tags/Git/" style="font-size: 0.88rem;">Git<sup>3</sup></a><a href="/tags/Git%E9%97%AE%E9%A2%98/" style="font-size: 0.88rem;">Git问题<sup>1</sup></a><a href="/tags/JavaScript/" style="font-size: 0.88rem;">JavaScript<sup>8</sup></a><a href="/tags/Koa/" style="font-size: 0.88rem;">Koa<sup>2</sup></a><a href="/tags/Node-js/" style="font-size: 0.88rem;">Node.js<sup>1</sup></a><a href="/tags/%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/" style="font-size: 0.88rem;">事件循环<sup>1</sup></a><a href="/tags/%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/" style="font-size: 0.88rem;">作用域链<sup>1</sup></a><a href="/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE/" style="font-size: 0.88rem;">原型链<sup>2</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">对象<sup>1</sup></a><a href="/tags/%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF/" style="font-size: 0.88rem;">开机自启<sup>1</sup></a><a href="/tags/%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1/" style="font-size: 0.88rem;">异步任务<sup>1</sup></a><a href="/tags/%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87/" style="font-size: 0.88rem;">执行上下文<sup>1</sup></a><a href="/tags/%E6%89%A7%E8%A1%8C%E6%A0%88/" style="font-size: 0.88rem;">执行栈<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E6%89%98%E7%9B%98/" style="font-size: 0.88rem;">系统托盘<sup>1</sup></a><a href="/tags/%E7%BB%A7%E6%89%BF/" style="font-size: 0.88rem;">继承<sup>1</sup></a><a href="/tags/%E9%97%AD%E5%8C%85/" style="font-size: 0.88rem;">闭包<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.20/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.4/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("11/01/2023 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.8",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 繁华落尽丶千 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.56.5/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "visitor@anheyu.com";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>